function C=Compute_C(B,A,lag)
n=size(B,1);
C=kron(A{1},speye(n))-kron(A{2},B(:,1:n));
switch lag
    case 2
        C=C-kron(A{3},B(:,n+1:2*n));
    case 3
        C=C-kron(A{3},B(:,n+1:2*n))-kron(A{4},B(:,2*n+1:3*n));
    case 4
        C=C-kron(A{3},B(:,n+1:2*n))-kron(A{4},B(:,2*n+1:3*n))...
            -kron(A{5},B(:,3*n+1:4*n));
    case 5
        C=C-kron(A{3},B(:,n+1:2*n))-kron(A{4},B(:,2*n+1:3*n))...
            -kron(A{5},B(:,3*n+1:4*n))-kron(A{6},B(:,4*n+1:5*n));
    case 6
       C=C-kron(A{3},B(:,n+1:2*n))-kron(A{4},B(:,2*n+1:3*n))...
            -kron(A{5},B(:,3*n+1:4*n))-kron(A{6},B(:,4*n+1:5*n)) - kron(A{7},B(:,5*n+1:6*n));    
    case 7
        C=C-kron(A{3},B(:,n+1:2*n))-kron(A{4},B(:,2*n+1:3*n))...
            -kron(A{5},B(:,3*n+1:4*n))-kron(A{6},B(:,4*n+1:5*n)) - kron(A{7},B(:,5*n+1:6*n)) - kron(A{8},B(:,6*n+1:7*n));   
    case 8
        C=C-kron(A{3},B(:,n+1:2*n))-kron(A{4},B(:,2*n+1:3*n))...
            -kron(A{5},B(:,3*n+1:4*n))-kron(A{6},B(:,4*n+1:5*n)) - kron(A{7},B(:,5*n+1:6*n)) ...
           - kron(A{8},B(:,6*n+1:7*n)) - kron(A{9},B(:,7*n+1:8*n)) ;
    case 9
        C=C-kron(A{3},B(:,n+1:2*n))-kron(A{4},B(:,2*n+1:3*n))...
            -kron(A{5},B(:,3*n+1:4*n))-kron(A{6},B(:,4*n+1:5*n)) - kron(A{7},B(:,5*n+1:6*n)) ...
           - kron(A{8},B(:,6*n+1:7*n)) - kron(A{9},B(:,7*n+1:8*n)) - kron(A{10},B(:,8*n+1:9*n)) ;
    case 10
           C=C-kron(A{3},B(:,n+1:2*n))-kron(A{4},B(:,2*n+1:3*n))...
            -kron(A{5},B(:,3*n+1:4*n))-kron(A{6},B(:,4*n+1:5*n)) - kron(A{7},B(:,5*n+1:6*n)) ...
           - kron(A{8},B(:,6*n+1:7*n)) - kron(A{9},B(:,7*n+1:8*n)) - kron(A{10},B(:,8*n+1:9*n)) ...
            - kron(A{11},B(:,9*n+1:10*n));

    case 11
            C=C-kron(A{3},B(:,n+1:2*n))-kron(A{4},B(:,2*n+1:3*n))...
            -kron(A{5},B(:,3*n+1:4*n))-kron(A{6},B(:,4*n+1:5*n)) - kron(A{7},B(:,5*n+1:6*n)) ...
           - kron(A{8},B(:,6*n+1:7*n)) - kron(A{9},B(:,7*n+1:8*n)) - kron(A{10},B(:,8*n+1:9*n)) ...
            - kron(A{11},B(:,9*n+1:10*n)) - kron(A{12},B(:,10*n+1:11*n)) ;

 case 12
        C=C-kron(A{3},B(:,n+1:2*n))-kron(A{4},B(:,2*n+1:3*n))...
            -kron(A{5},B(:,3*n+1:4*n))-kron(A{6},B(:,4*n+1:5*n)) - kron(A{7},B(:,5*n+1:6*n)) ...
           - kron(A{8},B(:,6*n+1:7*n)) - kron(A{9},B(:,7*n+1:8*n)) - kron(A{10},B(:,8*n+1:9*n)) ...
            - kron(A{11},B(:,9*n+1:10*n)) - kron(A{12},B(:,10*n+1:11*n)) - kron(A{13},B(:,11*n+1:12*n));       
       


    otherwise
        x=0;
end  

